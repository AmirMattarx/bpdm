{
  "info": {
    "_postman_id": "67fa306a-a4c1-4d70-80bb-370491d8d0a9",
    "name": "EDC BPDM Usage",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "1816771"
  },
  "item": [
    {
      "name": "Query Catalog",
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"@context\": {},\r\n    \"protocol\": \"dataspace-protocol-http\",\r\n    \"providerUrl\": \"{{PROVIDER_PROTOCOL_URL}}\",\r\n    \"querySpec\": {\r\n        \"offset\": 0,\r\n        \"limit\": 100,\r\n        \"filter\": \"\",\r\n        \"range\": {\r\n            \"from\": 0,\r\n            \"to\": 100\r\n        },\r\n        \"criterion\": \"\"\r\n    }\r\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/catalog/request",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "catalog",
            "request"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Initiate Negotation",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Body matches string\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.collectionVariables.set(\"NEGOTIATION_ID\", jsonData.id);",
              "",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@context\": {\n\t\t\"odrl\": \"http://www.w3.org/ns/odrl/2/\"\n\t},\n\t\"@type\": \"NegotiationInitiateRequestDto\",\n\t\"connectorAddress\": \"{{PROVIDER_PROTOCOL_URL}}\",\n\t\"protocol\": \"dataspace-protocol-http\",\n\t\"connectorId\": \"{{PROVIDER_ID}}\",\n\t\"providerId\": \"{{PROVIDER_ID}}\",\n\t\"offer\": {\n\t\t\"offerId\": \"{{CONTRACT_DEFINITION_ID}}:{{ASSET_ID}}:ZDM4Nzk3NmUtZjA0Ny00ZmNjLWFhNWItYjQwYmVkMDBhZGYy1\",\n\t\t\"assetId\": \"{{ASSET_ID}}\",\n\t\t\"policy\": {\n\t\t\t\"@type\": \"odrl:Set\",\n\t\t\t\"odrl:permission\": {\n\t\t\t\t\"odrl:target\": \"{{ASSET_ID}}\",\n\t\t\t\t\"odrl:action\": {\n\t\t\t\t\t\"odrl:type\": \"USE\"\n\t\t\t\t},\n\t\t\t\t\"odrl:constraint\": {\n\t\t\t\t\t\"odrl:or\": {\n\t\t\t\t\t\t\"odrl:leftOperand\": \"BusinessPartnerNumber\",\n\t\t\t\t\t\t\"odrl:operator\": {\n                            \"@id\": \"odrl:eq\"\n                        },\n\t\t\t\t\t\t\"odrl:rightOperand\": \"{{POLICY_BPN}}\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"odrl:prohibition\": [],\n\t\t\t\"odrl:obligation\": [],\n\t\t\t\"odrl:target\": \"{{ASSET_ID}}\"\n\t\t}\n\t}\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/contractnegotiations",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "contractnegotiations"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get Negotiation",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/contractnegotiations/{{NEGOTIATION_ID}}",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "contractnegotiations",
            "{{NEGOTIATION_ID}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Cancel Negotation by ID",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/contractnegotiations/{{NEGOTIATION_ID}}/cancel",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "contractnegotiations",
            "{{NEGOTIATION_ID}}",
            "cancel"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Initiate Transfer",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Body matches string\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.collectionVariables.set(\"TRANSFER_PROCESS_ID\", jsonData.id);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"@context\": {\n        \"odrl\": \"http://www.w3.org/ns/odrl/2/\"\n    },\n    \"assetId\": \"{{ASSET_ID}}\",\n    \"connectorAddress\": \"{{PROVIDER_PROTOCOL_URL}}\",\n    \"connectorId\": \"{{PROVIDER_ID}}\",\n    \"contractId\": \"{{AGREEMENT_ID}}\",\n    \"dataDestination\": {\n        \"type\": \"HttpProxy\"\n    },\n    \"managedResources\": false,\n    \"privateProperties\": {\n        \"receiverHttpEndpoint\": \"{{BACKEND_SERVICE}}\"\n    },\n    \"protocol\": \"dataspace-protocol-http\",\n    \"transferType\": {\n        \"contentType\": \"application/octet-stream\",\n        \"isFinite\": true\n    }\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/transferprocesses",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "transferprocesses"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get Transfer by ID",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/transferprocesses/{{TRANSFER_PROCESS_ID}}",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "transferprocesses",
            "{{TRANSFER_PROCESS_ID}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get all Transfers",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_MANAGEMENT_URL}}/transferprocesses/request",
          "host": [
            "{{CONSUMER_MANAGEMENT_URL}}"
          ],
          "path": [
            "transferprocesses",
            "request"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Initiate EDR Negotation",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Body matches string\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.collectionVariables.set(\"NEGOTIATION_ID\", jsonData.id);",
              "",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@context\": {\n\t\t\"odrl\": \"http://www.w3.org/ns/odrl/2/\"\n\t},\n\t\"@type\": \"NegotiationInitiateRequestDto\",\n\t\"connectorAddress\": \"{{PROVIDER_PROTOCOL_URL}}\",\n\t\"protocol\": \"dataspace-protocol-http\",\n\t\"connectorId\": \"{{PROVIDER_ID}}\",\n\t\"providerId\": \"{{PROVIDER_ID}}\",\n\t\"offer\": {\n\t\t\"offerId\": \"{{CONTRACT_DEFINITION_ID}}:{{ASSET_ID}}:ZDgyNTcwOGUtZGEyNy00MjEyLWE5M2UtMmVlYTI1ZjIyZjAz\",\n\t\t\"assetId\": \"{{ASSET_ID}}\",\n\t\t\"policy\": {\n\t\t\t\"@type\": \"odrl:Set\",\n\t\t\t\"odrl:permission\": {\n\t\t\t\t\"odrl:target\": \"{{ASSET_ID}}\",\n\t\t\t\t\"odrl:action\": {\n\t\t\t\t\t\"odrl:type\": \"USE\"\n\t\t\t\t},\n\t\t\t\t\"odrl:constraint\": {\n\t\t\t\t\t\"odrl:or\": {\n\t\t\t\t\t\t\"odrl:leftOperand\": \"BusinessPartnerNumber\",\n\t\t\t\t\t\t\"odrl:operator\": {\n                            \"@id\": \"odrl:eq\"\n                        },\n\t\t\t\t\t\t\"odrl:rightOperand\": \"{{POLICY_BPN}}\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"odrl:prohibition\": [],\n\t\t\t\"odrl:obligation\": [],\n\t\t\t\"odrl:target\": \"{{ASSET_ID}}\"\n\t\t}\n\t}\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_ADAPTER_URL}}/edrs",
          "host": [
            "{{CONSUMER_ADAPTER_URL}}"
          ],
          "path": [
            "edrs"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Query EDRs Cached",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Body matches string\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.collectionVariables.set(\"NEGOTIATION_ID\", jsonData.id);",
              "",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "GET",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_ADAPTER_URL}}/edrs?assetId={{ASSET_ID}}",
          "host": [
            "{{CONSUMER_ADAPTER_URL}}"
          ],
          "path": [
            "edrs"
          ],
          "query": [
            {
              "key": "assetId",
              "value": "{{ASSET_ID}}"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get EDR by tp ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Body matches string\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.collectionVariables.set(\"NEGOTIATION_ID\", jsonData.id);",
              "",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "GET",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{CONSUMER_ADAPTER_URL}}/edrs/{{EDR_ID}}",
          "host": [
            "{{CONSUMER_ADAPTER_URL}}"
          ],
          "path": [
            "edrs",
            "{{EDR_ID}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Public API GET",
      "request": {
        "auth": {
          "type": "apikey",
          "apikey": [
            {
              "key": "value",
              "value": "{{ASSET_ACCESS_API_KEY}}",
              "type": "string"
            },
            {
              "key": "key",
              "value": "Authorization",
              "type": "string"
            }
          ]
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{PROVIDER_PUBLIC_API}}",
          "host": [
            "{{PROVIDER_PUBLIC_API}}"
          ]
        }
      },
      "response": []
    }
  ],
  "auth": {
    "type": "apikey",
    "apikey": [
      {
        "key": "value",
        "value": "{{API-KEY}}",
        "type": "string"
      },
      {
        "key": "key",
        "value": "X-Api-Key",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "CONSUMER_MANAGEMENT_URL",
      "value": "https://sharing-member-edc-host/management/v2"
    },
    {
      "key": "PROVIDER_PROTOCOL_URL",
      "value": "https://gate-edc-host/api/v1/dsp"
    },
    {
      "key": "ASSET_ID",
      "value": "GET_BPL_INPUT_KEY",
      "type": "default"
    },
    {
      "key": "POLICY_ID",
      "value": "HAS_MEMBER_BPN",
      "type": "default"
    },
    {
      "key": "CONTRACT_POLICY_ID",
      "value": "HAS_MEMBER_BPN",
      "type": "default"
    },
    {
      "key": "ACCESS_POLICY_ID",
      "value": "HAS_MEMBER_BPN",
      "type": "default"
    },
    {
      "key": "CONTRACT_DEFINITION_ID",
      "value": "COMPANY_TEST_SHARING_MEMBER",
      "type": "default"
    },
    {
      "key": "POLICY_BPN",
      "value": "BPNL_SHARING_MEMBER",
      "type": "default"
    },
    {
      "key": "NEGOTIATION_ID",
      "value": ""
    },
    {
      "key": "AGREEMENT_ID",
      "value": ""
    },
    {
      "key": "TRANSFER_ID",
      "value": ""
    },
    {
      "key": "TRANSFER_PROCESS_ID",
      "value": ""
    },
    {
      "key": "BACKEND_SERVICE",
      "value": "https://backend-proxy",
      "type": "string"
    },
    {
      "key": "PROVIDER_ID",
      "value": "BPNL_GATE_PROVIDER",
      "type": "string"
    },
    {
      "key": "EDC_NAMESPACE",
      "value": "https://w3id.org/edc/v0.0.1/ns/",
      "type": "string"
    },
    {
      "key": "API-KEY",
      "value": "api-key",
      "type": "string"
    },
    {
      "key": "PROVIDER_PUBLIC_API",
      "value": "https://gate-edc-host/api/public",
      "type": "string"
    },
    {
      "key": "ASSET_ACCESS_API_KEY",
      "value": "",
      "type": "string"
    },
    {
      "key": "CONSUMER_ADAPTER_URL",
      "value": "https://sharing-member-edc-host/management",
      "type": "string"
    },
    {
      "key": "EDR_ID",
      "value": "",
      "type": "string"
    }
  ]
}